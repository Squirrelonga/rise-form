<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch Google Script Data</title>
</head>
<body>
    <script>
        // Function to get URL parameter by name
        function getUrlParameter(name) {
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(window.location.href);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Get the "question" parameter from the URL
        var questionParam = getUrlParameter("question");

        if (questionParam) {
            // Replace "question" in the URL with the parameter value
            var apiUrl = `https://script.google.com/macros/s/AKfycbxErUst99SyWz6pcFAr6DB1UIB9ozMZL5eoavxgttqSU8YDRt379uqn094eAHN2MnJLfg/exec?sheetName=Sheet1&cellAddress=${questionParam}`;

            // Make a GET request to the Google Script URL
            fetch(apiUrl)
                .then(function(response) {
                    return response.text();
                })
                .then(function(html) {
                    // Display the HTML response
                    document.body.innerHTML = html;
                })
                .catch(function(error) {
                    console.error('Error:', error);
                });
        } else {
            // Display a message if the "question" parameter is missing
            document.body.innerHTML = "Please provide a 'question' parameter in the URL.";
        }
    </script>
</body>
</html>
